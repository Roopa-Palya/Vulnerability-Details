Sample Vulnerable Code in Java:

String cmd = request.getParameter("cmd");
Runtime.getRuntime().exec(cmd);


The above code is vulnerable to Command Injection because it takes user input directly from the "cmd" parameter and passes it to the exec() method without proper validation or sanitization. An attacker can exploit this vulnerability by manipulating the "cmd" parameter to execute arbitrary commands on the server.

Sample Secure Code in Java to fix this vulnerability:

String cmd = request.getParameter("cmd");
if (!cmd.matches("[a-zA-Z0-9]+")) {
  // handle invalid input
} else {
  Runtime.getRuntime().exec(cmd);
}


The secure code includes input validation to ensure that the "cmd" parameter contains only alphanumeric characters. This prevents an attacker from injecting arbitrary commands into the application. In addition, the code uses parameterized queries or APIs that can help to prevent Command Injection attacks.

Organizations can use similar approaches to ensure that their applications do not have Command Injection vulnerabilities and protect themselves from unauthorized access to sensitive data and arbitrary command execution.
