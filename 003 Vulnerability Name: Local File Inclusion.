Sample Vulnerable Code in Java:

String page = request.getParameter("page");
File file = new File("/var/www/html/" + page);
FileReader reader = new FileReader(file);


The above code is vulnerable to LFI because it takes user input directly from the "page" parameter and uses it to include a local file on the server without proper validation or sanitization. An attacker can exploit this vulnerability by manipulating the "page" parameter to include sensitive files on the server.

Sample Secure Code in Java to fix this vulnerability:

String page = request.getParameter("page");
if (!page.matches("[a-zA-Z0-9]+")) {
  // handle invalid input
} else {
  File file = new File("/var/www/html/" + page);
  FileReader reader = new FileReader(file);
}


The secure code includes input validation to ensure that the "page" parameter contains only alphanumeric characters. This prevents an attacker from including files outside of the intended directory. In addition, the code checks whether the file exists before reading it, which prevents errors when attempting to read non-existent files.

Organizations can use similar approaches to ensure that their applications do not have LFI vulnerabilities and protect themselves from unauthorized access to sensitive data and arbitrary code execution.
