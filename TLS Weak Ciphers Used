Sample Vulnerable Code in Java:

SSLSocketFactory sslSocketFactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
SSLSocket sslSocket = (SSLSocket) sslSocketFactory.createSocket("www.example.com", 443);
String[] supportedCipherSuites = sslSocket.getSupportedCipherSuites();
sslSocket.setEnabledCipherSuites(supportedCipherSuites);
sslSocket.startHandshake();


Sample Secure Code in Java to fix this vulnerability:

SSLSocketFactory sslSocketFactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
SSLSocket sslSocket = (SSLSocket) sslSocketFactory.createSocket("www.example.com", 443);
String[] enabledCipherSuites = { "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384", "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256" };
sslSocket.setEnabledCipherSuites(enabledCipherSuites);
sslSocket.startHandshake();
