Sample Vulnerable Code in Java:

String comment = request.getParameter("comment");
String sql = "INSERT INTO comments (comment) VALUES ('" + comment + "')";
statement.execute(sql);


The above code is vulnerable to Stored XSS because it takes user input directly from the "comment" parameter and stores it in the database without proper validation or sanitization. An attacker can exploit this vulnerability by injecting malicious JavaScript code into the "comment" parameter, which will be stored in the database and executed whenever the comment is displayed on the page.

Sample Secure Code in Java to fix this vulnerability:

String comment = request.getParameter("comment");
if (!comment.matches("[a-zA-Z0-9]+")) {
  // handle invalid input
} else {
  String sql = "INSERT INTO comments (comment) VALUES (?)";
  PreparedStatement statement = connection.prepareStatement(sql);
  statement.setString(1, comment);
  statement.execute();
}


The secure code includes input validation to ensure that the "comment" parameter contains only alphanumeric characters. This prevents an attacker from injecting malicious JavaScript code into the parameter. In addition, the code uses a parameterized query to store the comment in the database, which helps to prevent SQL Injection attacks.

Organizations can use similar approaches to ensure that their applications do not have Stored XSS vulnerabilities and protect themselves from unauthorized access to sensitive data and malicious code execution.
