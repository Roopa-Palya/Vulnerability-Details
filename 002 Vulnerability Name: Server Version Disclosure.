Sample Vulnerable Code in Java:

// Server sends version information in response headers
response.setHeader("Server", "Apache/2.4.41 (Unix)");

// Server sends version information in error messages
try {
    // Some code here
} catch (Exception e) {
    // Server sends version information in error message
    response.sendError(500, "Internal server error: Apache/2.4.41 (Unix)");
}


Sample Secure Code in Java to fix this vulnerability:

// Server does not send version information in response headers
response.setHeader("Server", "MyServer");

// Server does not send version information in error messages
try {
    // Some code here
} catch (Exception e) {
    // Server sends generic error message without version information
    response.sendError(500, "Internal server error");
}


In the above example, the vulnerable code sends the server version information in the response headers and error messages. The secure code, on the other hand, removes the version information from the response headers and error messages, sending only generic information. Organizations can use similar approaches to ensure that their servers do not disclose version information and protect themselves from targeted attacks.
